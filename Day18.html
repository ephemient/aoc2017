<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Day18</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Day18.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">aoc2017-0.1.0.0: Advent of Code 2017 - my answers</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Day18</p></div><div id="description"><p class="caption">Description</p><div class="doc empty">&nbsp;</div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Ins">Ins</a> reg val<ul class="subs"><li>= <a href="#v:Rcv">Rcv</a> reg</li><li>| <a href="#v:Snd">Snd</a> (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</li><li>| <a href="#v:Set">Set</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</li><li>| <a href="#v:Add">Add</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</li><li>| <a href="#v:Mul">Mul</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</li><li>| <a href="#v:Mod">Mod</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</li><li>| <a href="#v:Jgz">Jgz</a> (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val) (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:MachineSpec">MachineSpec</a> m pc reg val = <a href="#v:MachineSpec">MachineSpec</a> {<ul class="subs"><li><a href="#v:program">program</a> :: <a href="../array-0.5.2.0/Data-Array.html#t:Array">Array</a> pc (<a href="Day18.html#t:Ins">Ins</a> reg val)</li><li><a href="#v:send">send</a> :: val -&gt; m ()</li><li><a href="#v:recv">recv</a> :: val -&gt; m val</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:MachineState">MachineState</a> pc reg val<ul class="subs"><li>= <a href="#v:MachineState">MachineState</a> { <ul class="subs"><li><a href="#v:pc">pc</a> :: pc</li><li><a href="#v:regs">regs</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> reg val</li></ul> }</li><li>| <a href="#v:MachineTerminated">MachineTerminated</a></li></ul></li><li class="src short"><a href="#v:parse">parse</a> :: <a href="../base-4.10.1.0/Text-Read.html#t:Read">Read</a> a =&gt; <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> -&gt; [<a href="Day18.html#t:Ins">Ins</a> <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> a]</li><li class="src short"><a href="#v:step">step</a> :: (<a href="../base-4.10.1.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.1.0/Data-Ix.html#t:Ix">Ix</a> pc, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> pc, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> reg, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> val, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> val) =&gt; <a href="Day18.html#t:MachineSpec">MachineSpec</a> m pc reg val -&gt; <a href="Day18.html#t:MachineState">MachineState</a> pc reg val -&gt; m (<a href="Day18.html#t:MachineState">MachineState</a> pc reg val)</li><li class="src short"><a href="#v:loop">loop</a> :: (<a href="../base-4.10.1.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.1.0/Data-Ix.html#t:Ix">Ix</a> pc, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> pc, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> reg, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> val, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> val) =&gt; <a href="Day18.html#t:MachineSpec">MachineSpec</a> m pc reg val -&gt; <a href="Day18.html#t:MachineState">MachineState</a> pc reg val -&gt; m ()</li><li class="src short"><a href="#v:day18a">day18a</a> :: <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int64">Int64</a></li><li class="src short"><a href="#v:day18b">day18b</a> :: <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.10.1.0/System-IO.html#t:IO">IO</a> <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Ins" class="def">Ins</a> reg val <a href="src/Day18.html#Ins" class="link">Source</a> <a href="#t:Ins" class="selflink">#</a></p><div class="doc"><p>A single instruction.</p><p><code><a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a></code> represents either a register reference or an immediate value.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Rcv" class="def">Rcv</a> reg</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Snd" class="def">Snd</a> (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Set" class="def">Set</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Add" class="def">Add</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Mul" class="def">Mul</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Mod" class="def">Mod</a> reg (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Jgz" class="def">Jgz</a> (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val) (<a href="../base-4.10.1.0/Data-Either.html#t:Either">Either</a> reg val)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MachineSpec" class="def">MachineSpec</a> m pc reg val <a href="src/Day18.html#MachineSpec" class="link">Source</a> <a href="#t:MachineSpec" class="selflink">#</a></p><div class="doc"><p>A specification for how to run a machine.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MachineSpec" class="def">MachineSpec</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:program" class="def">program</a> :: <a href="../array-0.5.2.0/Data-Array.html#t:Array">Array</a> pc (<a href="Day18.html#t:Ins">Ins</a> reg val)</dfn><div class="doc"><p>The list of instructions.</p></div></li><li><dfn class="src"><a id="v:send" class="def">send</a> :: val -&gt; m ()</dfn><div class="doc"><p>Handler for <code><a href="Day18.html#v:Snd">Snd</a></code>.</p></div></li><li><dfn class="src"><a id="v:recv" class="def">recv</a> :: val -&gt; m val</dfn><div class="doc"><p>Handler for <code><a href="Day18.html#v:Rcv">Rcv</a></code>.</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MachineState" class="def">MachineState</a> pc reg val <a href="src/Day18.html#MachineState" class="link">Source</a> <a href="#t:MachineState" class="selflink">#</a></p><div class="doc"><p>The current state of a machine.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MachineState" class="def">MachineState</a></td><td class="doc"><p>The machine is running.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:pc" class="def">pc</a> :: pc</dfn><div class="doc"><p>The program counter.</p></div></li><li><dfn class="src"><a id="v:regs" class="def">regs</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> reg val</dfn><div class="doc"><p>The registers.</p></div></li></ul></div></td></tr><tr><td class="src"><a id="v:MachineTerminated" class="def">MachineTerminated</a></td><td class="doc"><p>The machine is stopped.</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:parse" class="def">parse</a> :: <a href="../base-4.10.1.0/Text-Read.html#t:Read">Read</a> a =&gt; <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> -&gt; [<a href="Day18.html#t:Ins">Ins</a> <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> a] <a href="src/Day18.html#parse" class="link">Source</a> <a href="#v:parse" class="selflink">#</a></p><div class="doc"><p>Parse an assembly listing to instructions.</p></div></div><div class="top"><p class="src"><a id="v:step" class="def">step</a> :: (<a href="../base-4.10.1.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.1.0/Data-Ix.html#t:Ix">Ix</a> pc, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> pc, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> reg, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> val, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> val) =&gt; <a href="Day18.html#t:MachineSpec">MachineSpec</a> m pc reg val -&gt; <a href="Day18.html#t:MachineState">MachineState</a> pc reg val -&gt; m (<a href="Day18.html#t:MachineState">MachineState</a> pc reg val) <a href="src/Day18.html#step" class="link">Source</a> <a href="#v:step" class="selflink">#</a></p><div class="doc"><p>Evaluate a single instruction.</p></div></div><div class="top"><p class="src"><a id="v:loop" class="def">loop</a> :: (<a href="../base-4.10.1.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.1.0/Data-Ix.html#t:Ix">Ix</a> pc, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> pc, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> reg, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> val, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> val) =&gt; <a href="Day18.html#t:MachineSpec">MachineSpec</a> m pc reg val -&gt; <a href="Day18.html#t:MachineState">MachineState</a> pc reg val -&gt; m () <a href="src/Day18.html#loop" class="link">Source</a> <a href="#v:loop" class="selflink">#</a></p><div class="doc"><p>Run a machine until its state reaches <code><a href="Day18.html#v:MachineTerminated">MachineTerminated</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:day18a" class="def">day18a</a> :: <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int64">Int64</a> <a href="src/Day18.html#day18a" class="link">Source</a> <a href="#v:day18a" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:day18b" class="def">day18b</a> :: <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.10.1.0/System-IO.html#t:IO">IO</a> <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> <a href="src/Day18.html#day18b" class="link">Source</a> <a href="#v:day18b" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>